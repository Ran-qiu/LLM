# n8n 工作流模板库

这个目录包含预置的 n8n 工作流模板，可以直接导入到 n8n 中使用。

## 如何使用

1. 启动 n8n 服务：`docker-compose up -d n8n`
2. 访问 n8n Web UI：<http://localhost:5678>
3. 登录（默认用户名: admin, 密码: changeme123）
4. 点击 "Import from File" 导入工作流 JSON 文件

## 可用模板

### 1. daily_summary.json - 每日 AI 摘要

**功能**：每天定时生成 AI 摘要并发送邮件

**节点**：

- Cron 触发器（每天 9:00）
- HTTP 请求获取数据
- 调用 LLM 生成摘要
- 邮件发送

**适用场景**：

- 每日新闻摘要
- 项目进度报告
- 数据分析报告

---

### 2. webhook_chat.json - Webhook 触发对话

**功能**：通过 Webhook 接收消息并返回 LLM 响应

**节点**：

- Webhook 触发器
- 数据转换
- 调用 LLM API
- 返回响应

**适用场景**：

- Slack/Discord 机器人
- 客服系统集成
- API 网关

---

### 3. multi_model_compare.json - 多模型对比

**功能**：并行调用多个 LLM 模型并对比结果

**节点**：

- 手动触发
- 并行调用（GPT-4, Claude, Gemini）
- 结果合并
- 格式化输出

**适用场景**：

- 模型性能评估
- 答案质量对比
- A/B 测试

---

### 4. batch_processing.json - 批量处理

**功能**：批量处理数据并使用 LLM 分析

**节点**：

- 读取 CSV/JSON 数据
- 循环处理每条数据
- 批量调用 LLM
- 保存结果

**适用场景**：

- 批量文本分类
- 批量内容生成
- 数据标注

---

### 5. content_moderation.json - 内容审核

**功能**：自动审核用户提交的内容

**节点**：

- Webhook 接收内容
- 调用 LLM 进行审核
- 根据结果自动通过/拒绝
- 发送通知

**适用场景**：

- UGC 平台内容审核
- 评论过滤
- 广告合规检查

---

### 6. translation_pipeline.json - 多语言翻译

**功能**：多步骤翻译管道

**节点**：

- 接收源文本
- 并行调用多个翻译模型
- 对比翻译质量
- 选择最佳翻译

**适用场景**：

- 文档本地化
- 多语言内容生成
- 翻译质量评估

---

### 7. smart_customer_service.json - 智能客服

**功能**：自动处理客户咨询

**节点**：

- Webhook 接收客户消息
- 查询知识库
- 调用 LLM 生成回复
- 返回响应或转人工

**适用场景**：

- 在线客服
- FAQ 自动回复
- 工单预处理

---

### 8. document_summary.json - 文档批量总结

**功能**：定时读取文档并生成摘要

**节点**：

- 定时触发
- 读取文档目录
- 批量调用 LLM 生成摘要
- 保存到数据库

**适用场景**：

- 知识库维护
- 会议记录整理
- 报告自动生成

---

## 配置说明

所有模板中的 LLM API 调用都使用以下端点：

```
http://backend:8000/api/n8n/chat
```

### 请求格式

```json
{
  "provider": "openai",
  "model": "gpt-4",
  "messages": [
    {
      "role": "user",
      "content": "你的提示词"
    }
  ],
  "temperature": 0.7,
  "max_tokens": 1000
}
```

### 认证

如果启用了 Token 认证，需要在 HTTP 请求头中添加：

```
X-N8N-Token: your-token-here
```

## 自定义工作流

你可以基于这些模板创建自己的工作流：

1. 修改触发器（Cron、Webhook、手动等）
2. 调整 LLM 参数（模型、温度、Token 限制）
3. 添加数据转换节点
4. 集成外部服务（Slack、Email、数据库等）
5. 配置错误处理和重试逻辑

## 最佳实践

### 性能优化

- 使用批处理减少 API 调用
- 合理设置超时时间
- 启用缓存减少重复请求

### 错误处理

- 添加错误捕获节点
- 配置失败重试（最多 3 次）
- 记录详细日志

### 安全性

- 使用环境变量存储敏感信息
- 限制 Webhook 访问来源
- 定期轮换 API Token

## 贡献模板

欢迎贡献新的工作流模板！

1. 创建工作流并测试
2. 导出为 JSON 文件
3. 添加到此目录
4. 更新此 README

## 问题反馈

如遇到问题，请查看：

- n8n 执行日志
- 后端 API 日志
- 网络连接状态

更多信息请参考：[开发文档.md](../../开发文档.md)
